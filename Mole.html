<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whack-a-Mole Game</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                fontFamily: {
                    sans: ['Inter', 'sans-serif'],
                    heading: ['Outfit', 'sans-serif'],
                },
                extend: {
                    colors: {
                        primary: '#6c5ce7',
                        secondary: '#a29bfe',
                        accent: '#fd79a8',
                        dark: '#1e202a',
                        surface: '#2b2e3b',
                        warning: '#fdcb6e',
                    }
                }
            }
        }
    </script>
    <style>
        /* Specific Game Visuals */
        .hole {
            position: relative;
            width: 100%;
            padding-bottom: 100%;
            background: #5d4037;
            border-radius: 50%;
            box-shadow: inset 0 10px 20px rgba(0, 0, 0, 0.7), 0 5px 15px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            cursor: pointer;
        }
        .hole::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 100%;
            height: 50%;
            background: rgba(0,0,0,0.2);
            border-radius: 50%;
            pointer-events: none;
        }
        .mole {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, 100%);
            width: 70%;
            height: 70%;
            background: #8d6e63;
            border-radius: 40% 40% 20% 20%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 10;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .mole.up {
            transform: translate(-50%, -30%);
        }
        .mole::before { /* Eyes */
            content: '..';
            position: absolute;
            top: 20%;
            color: #3e2723;
            font-size: 20px;
            font-weight: bold;
            letter-spacing: 12px;
        }
        .mole::after { /* Nose */
            content: '';
            position: absolute;
            top: 45%;
            width: 12px;
            height: 8px;
            background: #ffccbc;
            border-radius: 50%;
        }
    </style>
</head>
<body class="bg-[#13151b] text-white min-h-screen flex items-center justify-center p-4 font-sans overflow-x-hidden selection:bg-warning selection:text-black">

    <div class="w-full max-w-lg bg-surface/30 backdrop-blur-xl rounded-3xl p-6 md:p-8 shadow-2xl border border-white/5 relative overflow-hidden">
        
        <!-- Header -->
        <header class="text-center mb-8 relative z-10">
            <h1 class="text-3xl md:text-4xl font-black font-heading bg-clip-text text-transparent bg-gradient-to-r from-yellow-400 to-orange-500 mb-2 drop-shadow-sm">
                WHACK-A-MOLE
            </h1>
            <p class="text-gray-400 text-sm md:text-base">Whack as many as you can in 30 seconds!</p>
            <a href="index.html" class="inline-block mt-2 text-xs text-gray-500 hover:text-white transition-colors">
                <i class="fas fa-arrow-left"></i> Back to Hub
            </a>
        </header>

        <!-- Stats -->
        <div class="flex gap-4 mb-8 relative z-10">
            <div class="flex-1 bg-black/20 rounded-2xl p-4 text-center border border-white/5 backdrop-blur-sm">
                <div class="text-xs text-gray-400 font-bold tracking-wider mb-1 uppercase">Time Left</div>
                <div id="timer" class="text-3xl font-bold text-yellow-400 font-heading">30</div>
            </div>
            <div class="flex-1 bg-black/20 rounded-2xl p-4 text-center border border-white/5 backdrop-blur-sm">
                <div class="text-xs text-gray-400 font-bold tracking-wider mb-1 uppercase">Score</div>
                <div id="score" class="text-3xl font-bold text-orange-400 font-heading">0</div>
            </div>
        </div>

        <!-- High Score -->
        <div class="text-center mb-6 relative z-10">
            <div class="inline-flex items-center gap-2 bg-white/5 px-4 py-2 rounded-full border border-white/10">
                <span class="text-xs text-gray-400 font-bold uppercase">High Score</span>
                <span id="high-score" class="text-lg font-bold text-green-400">0</span>
            </div>
        </div>

        <!-- Game Board -->
        <div class="game-board grid grid-cols-3 gap-4 max-w-xs mx-auto mb-8 relative z-10">
            <!-- Holes injected by JS -->
        </div>

        <!-- Controls -->
        <div class="flex gap-4 relative z-10">
            <button id="start-btn" class="flex-1 py-3.5 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl font-bold text-white shadow-lg shadow-green-500/20 hover:shadow-green-500/40 hover:-translate-y-1 transition-all active:translate-y-0 text-sm md:text-base tracking-wide flex items-center justify-center gap-2">
                <i class="fas fa-play"></i> START
            </button>
            <button id="reset-btn" class="flex-1 py-3.5 bg-gradient-to-r from-red-500 to-rose-600 rounded-xl font-bold text-white shadow-lg shadow-red-500/20 hover:shadow-red-500/40 hover:-translate-y-1 transition-all active:translate-y-0 text-sm md:text-base tracking-wide flex items-center justify-center gap-2">
                <i class="fas fa-redo"></i> RESET
            </button>
        </div>

        <!-- Grass Decoration -->
        <div class="absolute bottom-0 left-0 w-full h-24 bg-gradient-to-t from-emerald-900/50 to-transparent pointer-events-none z-0"></div>

    </div>

    <!-- Game Over Modal -->
    <div class="fixed inset-0 bg-black/90 backdrop-blur-md flex flex-col justify-center items-center z-50 transition-opacity duration-300 pointer-events-none opacity-0" id="game-over">
        <div class="bg-surface/50 p-8 rounded-3xl border border-white/10 text-center max-w-sm w-full mx-4 shadow-2xl transform scale-95 transition-transform duration-300" id="game-over-content">
            <h2 class="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-500 mb-6 font-heading">TIME'S UP!</h2>
            
            <div class="mb-8">
                <div class="text-gray-400 text-sm uppercase tracking-wide mb-2">Final Score</div>
                <div class="text-6xl font-bold text-white mb-4" id="final-score">0</div>
                
                <div id="new-high-score-message" class="hidden animate-bounce text-green-400 font-bold mb-2">
                    <i class="fas fa-trophy"></i> NEW HIGH SCORE!
                </div>
                <div class="text-sm text-gray-500">Best: <span id="game-over-high-score">0</span></div>
            </div>

            <button id="play-again-btn" class="w-full py-4 bg-white text-black text-lg font-bold rounded-xl hover:scale-105 transition-all shadow-xl hover:shadow-2xl">
                Play Again
            </button>
        </div>
    </div>

    <!-- Instructions -->
    <div class="fixed bottom-4 left-1/2 -translate-x-1/2 text-center text-gray-500 text-xs md:text-sm pointer-events-none">
        Tap moles to score â€¢ Don't miss!
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Game elements
            const gameBoard = document.querySelector('.game-board');
            const timerDisplay = document.getElementById('timer');
            const scoreDisplay = document.getElementById('score');
            const startBtn = document.getElementById('start-btn');
            const resetBtn = document.getElementById('reset-btn');
            const gameOverScreen = document.getElementById('game-over');
            const gameOverContent = document.getElementById('game-over-content');
            const finalScoreDisplay = document.getElementById('final-score');
            const highScoreDisplay = document.getElementById('high-score');
            const gameOverHighScoreDisplay = document.getElementById('game-over-high-score');
            const playAgainBtn = document.getElementById('play-again-btn');
            const newHighScoreMessage = document.getElementById('new-high-score-message');
            
            // Game variables
            let score = 0;
            let timeLeft = 30;
            let gameActive = false;
            let timer;
            let moleTimer;
            let currentMole = null;
            let moleSpeed = 1000; // Initial speed in ms
            let highScore = localStorage.getItem('whackMoleHighScore') || 0;
            
            // Audio Context for Sounds
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            
            function playSound(type) {
                if (audioCtx.state === 'suspended') {
                    audioCtx.resume();
                }
                const oscillator = audioCtx.createOscillator();
                const gainNode = audioCtx.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioCtx.destination);
                
                if (type === 'pop') {
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(600, audioCtx.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(300, audioCtx.currentTime + 0.1);
                    gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
                    oscillator.start();
                    oscillator.stop(audioCtx.currentTime + 0.1);
                } else if (type === 'whack') {
                    oscillator.type = 'square';
                    oscillator.frequency.setValueAtTime(150, audioCtx.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.1);
                    gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
                    oscillator.start();
                    oscillator.stop(audioCtx.currentTime + 0.1);
                } else if (type === 'gameover') {
                     oscillator.type = 'triangle';
                     oscillator.frequency.setValueAtTime(300, audioCtx.currentTime);
                     oscillator.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.5);
                     gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
                     gainNode.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.5);
                     oscillator.start();
                     oscillator.stop(audioCtx.currentTime + 0.5);
                }
            }

            // Create holes
            for (let i = 0; i < 9; i++) {
                const hole = document.createElement('div');
                hole.className = 'hole';
                hole.dataset.index = i;
                
                const mole = document.createElement('div');
                mole.className = 'mole';
                mole.innerHTML = ''; // Specific CSS handles the face eyes/nose now for cleaner look
                
                hole.appendChild(mole);
                gameBoard.appendChild(hole);
                
                // Add event listeners for whacking
                const whackHandler = (e) => {
                     e.preventDefault();
                    if (gameActive && mole.classList.contains('up')) {
                        whackMole(mole);
                    }
                };
                
                hole.addEventListener('mousedown', whackHandler);
                hole.addEventListener('touchstart', whackHandler);
            }
            
            // Initialize high score display
            highScoreDisplay.textContent = highScore;
            gameOverHighScoreDisplay.textContent = highScore;
            
            // Start game
            startBtn.addEventListener('click', startGame);
            
            // Reset game
            resetBtn.addEventListener('click', resetGame);
            
            // Play again
            playAgainBtn.addEventListener('click', () => {
                hideGameOver();
                resetGame();
                startGame();
            });
            
            // Start the game
            function startGame() {
                if (gameActive) return;
                
                gameActive = true;
                score = 0;
                timeLeft = 30;
                moleSpeed = 1000;
                scoreDisplay.textContent = score;
                timerDisplay.textContent = timeLeft;
                
                // Start timer
                timer = setInterval(() => {
                    timeLeft--;
                    timerDisplay.textContent = timeLeft;
                    
                    if (timeLeft <= 0) {
                        endGame();
                    }
                }, 1000);
                
                // Start showing moles
                showRandomMole();
            }
            
            // Reset game
            function resetGame() {
                gameActive = false;
                clearInterval(timer);
                clearTimeout(moleTimer);
                
                // Hide any visible moles
                document.querySelectorAll('.mole.up').forEach(mole => {
                    mole.classList.remove('up');
                });
                
                score = 0;
                timeLeft = 30;
                moleSpeed = 1000;
                scoreDisplay.textContent = score;
                timerDisplay.textContent = timeLeft;
                
                hideGameOver();
            }
            
            // Show a random mole
            function showRandomMole() {
                if (!gameActive) return;
                
                // Hide current mole if exists
                if (currentMole) {
                    currentMole.classList.remove('up');
                }
                
                // Select a random hole
                const holes = document.querySelectorAll('.hole');
                const randomIndex = Math.floor(Math.random() * holes.length);
                const hole = holes[randomIndex];
                const mole = hole.querySelector('.mole');
                
                // Show the mole
                mole.classList.add('up');
                currentMole = mole;
                
                // Play pop sound
                playSound('pop');
                
                // Scale difficulty
                const stayTime = Math.max(400, moleSpeed - 100);

                // Set timeout to hide the mole
                setTimeout(() => {
                    if (mole.classList.contains('up')) {
                        mole.classList.remove('up');
                    }
                }, stayTime); // Mole stays up for a bit
                
                // Schedule next mole
                moleTimer = setTimeout(() => {
                    showRandomMole();
                }, moleSpeed);
                
                // Increase difficulty
                if (moleSpeed > 500) {
                    moleSpeed -= 20;
                }
            }
            
            // Whack a mole
            function whackMole(mole) {
                mole.classList.remove('up');
                score++;
                scoreDisplay.textContent = score;
                
                // Play whack sound
                playSound('whack');
                
                // Add visual feedback
                mole.style.transform = 'translate(-50%, 100%) scale(0.9)'; // Squish
                setTimeout(() => {
                    mole.style.transform = '';
                }, 200);
            }
            
            // End the game
            function endGame() {
                gameActive = false;
                clearInterval(timer);
                clearTimeout(moleTimer);
                playSound('gameover');

                // Hide any visible moles
                document.querySelectorAll('.mole.up').forEach(mole => {
                    mole.classList.remove('up');
                });
                
                // Update high score
                if (score > highScore) {
                    highScore = score;
                    localStorage.setItem('whackMoleHighScore', highScore);
                    highScoreDisplay.textContent = highScore;
                    gameOverHighScoreDisplay.textContent = highScore;
                    newHighScoreMessage.classList.remove('hidden');
                } else {
                    newHighScoreMessage.classList.add('hidden');
                }
                
                // Show game over screen
                finalScoreDisplay.textContent = score;
                showGameOver();
            }

            function showGameOver() {
                gameOverScreen.classList.remove('opacity-0', 'pointer-events-none');
                gameOverScreen.classList.add('opacity-100', 'pointer-events-auto');
                gameOverContent.classList.remove('scale-95');
                gameOverContent.classList.add('scale-100');
            }

            function hideGameOver() {
                gameOverScreen.classList.add('opacity-0', 'pointer-events-none');
                gameOverScreen.classList.remove('opacity-100', 'pointer-events-auto');
                gameOverContent.classList.add('scale-95');
                gameOverContent.classList.remove('scale-100');
            }
        });
    </script>
</body>
</html>
